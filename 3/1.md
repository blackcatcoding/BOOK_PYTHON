# 1.服务器起航

> 从在浏览器输入网址，到能看到网页，虽然可能只有短短的0.1秒，但这其中计算机执行了多少条命令，网页又经过了怎样的迂回曲折才呈现在你的面前的呢？

![](..\.gitbook\assets\3\1.png)



## 计算机网络连接

> 通常情况下，浏览器在一台计算机上，而显示的网页在另外一台计算机上，它们之间通过网络连接。

![](..\.gitbook\assets\3\2.png)

## 域名与IP

> 网址表示想要访问的页面，不同网址会对应不同页面。网址中包含域名，域名一般以www开始，以.cn或者.com,.org等结尾，同一个域名下可以有多个网址。

![](..\.gitbook\assets\3\3.png)



> 网络是由多台计算机组成的，如何定位到其中的一台计算机呢？可以给计算机编号，由此ip地址应运而生。当前使用的大部分ip地址说ipv4地址，ipv4由32位组成，为方便书写用点分隔成4段，每段8位，2的8次方等于256，所以每一位的范围是0-255，ipv4总共有43亿个地址。

![](..\.gitbook\assets\3\4.png)



> 那么域名和ip地址又是怎么对应起来的呢，对于浏览器来说，输入网址后，它会从网址中取出域名，然后通过访问DNS获得域名对应的ip地址。DNS表示域名服务器，可以理解为DNS有一张表，表中记录了所有的域名和ip地址的对应关系，只要你给我域名，我给你查出对应的ip地址。

![](..\.gitbook\assets\3\5.png)



## 服务器

> 你的计算机拿到另外一台计算机的ip地址后，你的计算机就会将你的请求发送给ip地址对应的那台计算机，其他计算机也会发出同样的请求，这样的请求都通过网络来到了这台目标计算机，像这样的被其他计算机访问的计算机，称为服务器。

![](..\.gitbook\assets\3\6.png)



## 端口号

> 一台服务器上可以同时提供多种不同的服务：Web服务，也就是提供网页；FTP服务，提供文件存储和访问；邮件服务，提供电子邮件收发，这些服务分别由不同的服务器程序来完成。但是一个网络请求来到服务器，服务器怎么知道这个请求想要什么服务呢？

![](..\.gitbook\assets\3\7.png)



> 浏览器发送请求时可以携带信息给服务器，告诉服务器获取哪种服务就可以了。那这个信息在计算机系统其实就是“端口号”。

![](..\.gitbook\assets\3\8.png)

> 我们在使用浏览器时，没有用过端口号。实际上在发送请求时，如果是获取网页，浏览器自动添加了默认端口。

![](..\.gitbook\assets\3\9.png)



## 响应

> 通过刚才的一系统步骤，浏览器端的请求已经找到了服务器这台计算机，并且由服务器上某个具体的服务器程序来处理请求。然后服务器程序根据网址中不同的路径或者文件名给浏览器返回对应的页面。
>
> 当服务器返回的内容通过网络到达浏览器，经由浏览器解析后就显示出来。这里，将服务器给浏览器返回的内容，称之为响应。

![](..\.gitbook\assets\3\10.png)

> 从输入网址开始到看到网页的整个流程就是这样的，对于计算机和网络来说，这些事情可能只用了0.1秒，但要理解这个流程，还是要花些功夫的。



## Flask框架

Flask诞生于2010年，是Armin ronacher（人名）用Python语言基于Werkzeug工具箱编写的轻量级Web开发框架。它主要面向需求简单的小应用。

Flask本身相当于一个内核，其他几乎所有的功能都要用到扩展（邮件扩展Flask-Mail，用户认证Flask-Login），都需要用第三方的扩展来实现。比如可以用Flask-extension加入ORM、窗体验证工具，文件上传、身份验证等。Flask没有默认使用的数据库，你可以选择MySQL，也可以用NoSQL。其 WSGI 工具箱采用 Werkzeug（路由模块） ，模板引擎则使用 Jinja2 。

可以说Flask框架的核心就是Werkzeug和Jinja2。

Python最出名的框架要数Django，此外还有Flask、Tornado等框架。虽然Flask不是最出名的框架，但是Flask应该算是最灵活的框架之一，这也是Flask受到广大开发者喜爱的原因。

### Flask扩展包

- Flask-SQLalchemy：操作数据库；
- Flask-migrate：管理迁移数据库；
- Flask-Mail:邮件；
- Flask-WTF：表单；
- Flask-script：插入脚本；
- Flask-Login：认证用户状态；
- Flask-RESTful：开发REST API的工具；
- Flask-Bootstrap：集成前端Twitter Bootstrap框架；
- Flask-Moment：本地化日期和时间；



### Hello,World!

```python
# 从flask模块导入Flask类

from flask import Flask

# 创建flask对象app
app = Flask(__name__)

# 设置访问路径
@app.route('/hello')
def hello():

    # 返回响应内容
    return 'Hello, World!'

if __name__ == '__main__':

    # 启动服务器程序
    app.run(host='127.0.0.1', port='8080')
```



然而，如果我们想要更改返回的响应内容，比如`return 'Hello, cat!'`，刷新网页并没有改变，需要重启服务器，这样比较麻烦，我们可以假如调试功能，修改代码保存后，直接刷新网页就可以访问新的内容。

```python
app.debug = True
```



### 返回页面

返回信息本质上是一个字符串，但是我们把字符串加上html的标签也可以渲染出来，比如`return '<h1>Hello, cat!</h1>'`，返回的文字就是一个标题，然而网页构成很复杂，我们不可能把所有的内容都通过return返回。

```python
from flask render_template
return render_template('index.html')
```



### Flask目录结构

在flask目录中，app.py是主应用程序，templates中存放用到的HTML文件，注意这个目录必须是templates，如果不是这个目录名，就导致flask程序找不到页面的。css、js，图片文件等这些，放在和templates同级的static目录下，为了对这些文件进行更好地管理，一般会在static目录中创建js、css、image目录分别存放。

<img src="..\.gitbook\assets\3\11.png" style="zoom:67%;" />